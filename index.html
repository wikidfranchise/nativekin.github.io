<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NativeKin Tribal Directory</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      padding: 20px;
      background-color: #f7f7f7;
      color: #222;
      margin: 0;
    }
    h1 {
      font-size: 2rem;
      color: #008080;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    .search-container {
      position: relative;
      width: 100%;
      max-width: 700px;
      margin: 20px auto;
    }
    input[type="text"]#tribeSearchInput {
      padding: 12px 15px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      width: 100%;
      box-sizing: border-box;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    input[type="text"]#tribeSearchInput:focus {
      border-color: #008080;
      outline: none;
      box-shadow: 0 0 8px rgba(0, 128, 128, 0.3);
    }
    .custom-dropdown {
      display: none;
      position: absolute;
      background-color: white;
      width: 100%;
      border: 1px solid #ccc;
      border-top: none;
      border-radius: 0 0 8px 8px;
      max-height: 350px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      box-sizing: border-box;
    }
    .custom-dropdown .dropdown-item {
      padding: 10px 15px;
      cursor: pointer;
      border-bottom: 1px solid #eee;
      font-size: 15px;
    }
    .custom-dropdown .dropdown-item:last-child {
      border-bottom: none;
    }
    .custom-dropdown .dropdown-item:hover {
      background-color: #f0f0f0;
    }
    .card {
      background: white;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      max-width: 700px;
      margin: 30px auto;
    }
    .card div {
        margin-bottom: 8px;
        line-height: 1.6;
    }
    .card strong {
        color: #005050;
        font-size: 1.25em;
    }
  </style>
</head>
<body>
  <h1>NativeKin Tribal Directory</h1>
  <div class="search-container">
    <input type="text" id="tribeSearchInput" placeholder="Search or select your tribe..." autocomplete="off" />
    <div id="customTribeDropdown" class="custom-dropdown"></div>
  </div>
  <div id="tribeInfoOutput"></div>
  <div id="newsArticlesOutput"></div>
  <script>
    const tribes = [
      "Absentee-Shawnee Tribe of Indians of Oklahoma", "Agua Caliente Band of Cahuilla Indians of the Agua Caliente Indian Reservation, California", "Ak Chin Indian Community", "Alabama-Coushatta Tribe of Texas", "Alabama-Quassarte Tribal Town", "Alturas Indian Rancheria, California", "Apache Tribe of Oklahoma", "Arapaho Tribe of the Wind River Reservation, Wyoming", "Aroostook Band of Micmacs", "Assiniboine and Sioux Tribes of the Fort Peck Indian Reservation, Montana",
      "Bad River Band of the Lake Superior Tribe of Chippewa Indians of the Bad River Reservation, Wisconsin", "Bay Mills Indian Community, Michigan", "Bear River Band of the Rohnerville Rancheria, California", "Berry Creek Rancheria of Maidu Indians of California", "Big Lagoon Rancheria, California", "Big Pine Paiute Tribe of the Owens Valley, California"
      // ... continue full list
    ];

    const articles = [];

    async function fetchArticles() {
      const res = await fetch('media/nativekin_aggregated_articles.json');
      const data = await res.json();
      articles.push(...data);
    }

    function renderArticlesForTribe(tribeName) {
      const output = document.getElementById('newsArticlesOutput');
      const tribeLower = tribeName.toLowerCase();
      const matchingArticles = articles.filter(a => (a.tribe || '').toLowerCase() === tribeLower);

      output.innerHTML = '';

      if (matchingArticles.length === 0) {
        output.innerHTML = `<div class="card"><strong>No articles found for ${tribeName}</strong></div>`;
        return;
      }

      matchingArticles.forEach(article => {
        output.innerHTML += `
          <div class="card">
            <div><strong>${article.title}</strong></div>
            <div>${article.summary}</div>
            <div><a href="${article.link}" target="_blank">Read more</a></div>
          </div>
        `;
      });
    }

    const input = document.getElementById('tribeSearchInput');
    const dropdown = document.getElementById('customTribeDropdown');

    input.addEventListener('input', () => {
      const value = input.value.toLowerCase();
      const matches = tribes.filter(t => t.toLowerCase().includes(value));
      dropdown.innerHTML = matches.map(t => `<div class="dropdown-item">${t}</div>`).join('');
      dropdown.style.display = matches.length ? 'block' : 'none';
    });

    dropdown.addEventListener('click', e => {
      if (e.target.classList.contains('dropdown-item')) {
        const tribeName = e.target.textContent;
        input.value = tribeName;
        dropdown.style.display = 'none';
        renderArticlesForTribe(tribeName);
      }
    });

    fetchArticles();
  </script>
</body>
</html>
